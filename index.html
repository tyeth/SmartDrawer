<html>
<body>
<div id="first" style="clear: both; text-align: center;">
<h1>
Success...!!!</h1>
<a href="https://1.bp.blogspot.com/-vMYPmjSkWOc/WD0BmyKwbyI/AAAAAAAAAuU/KLxqOuja3F8yT-OD-WH2DkJv3k2YPBNxwCLcB/s1600/Done.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="255" src="https://1.bp.blogspot.com/-vMYPmjSkWOc/WD0BmyKwbyI/AAAAAAAAAuU/KLxqOuja3F8yT-OD-WH2DkJv3k2YPBNxwCLcB/s400/Done.png" width="400" /></a><br />
<b> Your 20 character Authorisation Code is... </b>
<h2 id="auth">
</h2> 
Please press config button on your device and enter above Authorisation Code to Validate your Device with Amazon DRS
<br />

</div>
<div id="myDiv" style="clear: both; text-align: center;">
<h1>
Register for Amazon DRS..</h1>
<form action="form_action.asp" id="frm1">
  <b>PRODUCT MODEL ID </b> <br /> <input maxlength="36" name="pname" size="38" style="text-align: center;" type="text" value="WCPAPER002" /><br /><br />
  <b>SERIAL NO </b><br /> <input maxlength="12" name="sname" size="14" style="text-align: center;" type="text" value="WCPAPER00201" /><br /><br />
  <input onclick="lwaFunction()" type="button" value="Login with Amazon" />
</form>
</div>
<br />
<br />

<script>
function defFunction() {
    var str = String(window.location);
    var pos = str.indexOf("code=");
    if(pos != -1)
    {
       myDiv.style.display = "none";
       var str = String(window.location);
       var res = str.substring(pos+5,pos+25);
       document.getElementById("auth").innerHTML = res;
    }
}
function lwaFunction() {
    var str = String(window.location);
    var pos = str.indexOf("code=");
    if(pos == -1)
    {
        var x1 = document.getElementById("frm1");
        var productid = String(x1.elements[0].value);
        var serialno = String(x1.elements[1].value);
        var clientid = "application-oa2-client.1d46c0b931e74813bda81d4e1c776b1c";
        window.open("https://www.amazon.com/ap/oa?client_id="+clientid+"&scope=dash%3Areplenish&scope_data=%7B%22dash%3Areplenish%22%3A%7B%22device_model%22%3A%22"+productid+"%22%2C%22serial%22%3A%22"+serialno+"%22%2C%22is_test_device%22%3Atrue%7D%7D&response_type=code&redirect_uri=https://spadgenske.github.io/SmartDrawer/redirect");
    }
}
function fstFunction() {
    var str = String(window.location);
    var pos = str.indexOf("code=");
    if(pos == -1)
    {
        first.style.display = "none";
    }
}
defFunction();
fstFunction() 
</script>
</body>

</html>
